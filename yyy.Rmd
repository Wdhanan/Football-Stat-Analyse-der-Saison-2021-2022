---
title: "Fußball Statistic Analyse in Europa Ligas"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(RColorBrewer)
library(dplyr)
library(plotly)
library(ggplot2)
myPalette<- brewer.pal(8,"Set2")

yo<- read_delim("VDA/data/2021-2022 Football Team Stats.csv", 
    delim = ";", escape_double = FALSE, locale = locale(encoding = "ISO-8859-2"), 
    trim_ws = TRUE)
hallo1<- as.data.frame(yo)
hallogt<-yo %>% separate(col = "Top Team Scorer", into = c("BestScorer","GoalScored"), sep=" - ")


hallo2<- hallo1 %>%
  mutate(
    average=sum(Attendance)/98,
    
  ) %>%
  filter(Attendance<average) %>%
     select(Squad, Country,Attendance)

hallo3 <- hallo1 %>%
  group_by(Country) %>%
  mutate(
    summe=sum(Pts),
    
  ) %>%
  select(Squad, Country,summe)
# lander mit punkten grosser als die average
hallo4<- yo %>%
  mutate(
    average=sum(Pts)/5
  ) %>%
  group_by(Country) %>%
  mutate(
    summe=sum(Pts)
    ) %>%
  filter(summe > average) %>%
  select( Country,summe,average)

hallo5<-yo %>%
  mutate(
    average=sum(W)/98
  ) %>%
  filter(W> average) %>%
 select(Squad,W,average)

hallo6<- yo %>%
  mutate(
    average=sum(Pts)/98
  ) %>%
  filter(Pts< average) %>%
 select(Squad,Pts,average)

hallo7<-yo %>%
  mutate(
    average=sum(GD)/98
  ) %>%
  filter(GD> average) %>%
 select(Squad,GD,average)

hallo8<-yo %>%
  mutate(
    average=sum(`Pts/G`)/98
  ) %>%
  filter(`Pts/G`< average) %>%
 select(Squad,`Pts/G`,average,GF)

hallo9<-hallogt %>%
  mutate(
    Average=sum(as.numeric(GoalScored))/98
    
  ) %>% 
  filter(GoalScored > Average) %>%
  select(BestScorer, GoalScored ,Average)

hallo10<-hallogt %>%
  group_by(Country)%>%
  mutate(
    Average=sum(as.numeric(GoalScored))/98
    
  ) %>% 
  filter(GoalScored > Average) %>%
  select(BestScorer, GoalScored ,Average,Country)

hallo11<- hallogt %>%
  mutate(
    GPMA=as.numeric(GoalScored)/MP,
    Average=sum(GPMA)/98
    
  ) %>% 
  filter(GPMA> Average) %>%
  select(BestScorer, GoalScored ,GPMA,Country)

hallo12<- hallogt %>%
 group_by(Country)%>%
  mutate(
    GPMA=as.numeric(GoalScored)/MP,
    Average=sum(GPMA)/98
    
  ) %>% 
  filter(GPMA> Average) %>%
  select(BestScorer, GoalScored ,GPMA,Country)




```

Vorgehen in dieser Visualisierung
=======================================================================




                                      Datensatz und Quelle 




In dieser Visualisierung geht es um eine Statistik von den Mannschaften aus den 5 besten
Europa Ligas (Deutschland, Frankreich, Spanien, Großbritanien und Italien). Der Datensatz wurde bei Kaggle gefunden. Unter dem folgenden Link https://www.kaggle.com/datasets/vivovinco/20212022-football-team-stats können Sie darauf 
zugreifen. Darin gibt es insgesamt 98 Mannsachaften, die über 21 unterschiedliche Merkmale
wie(Attendance, Goalscored, Bestscorer, Pts, GD, usw.) miteinander verglichen werden.



                                      Einlesemethode der Daten
                                    
Die Daten werden erstmal mithilfe von read_delim eingelesen, da die Merkmale durch ein Semikolon getrennt werden. Danach werden sie in einem Data frame ausgelagert. Der Grund dafür ist einfach. Mit einem Data frame und mithilfe von dem Pipeline, Filter, select, mutate,usw. ist es möglich nur auf bestimmte Merkmale zuzugreifen und das vereinfacht die Visualisierung. Die verwendete Encoding  hier ist ISO-8859-2. Damit is es auch möglich einige Charakter einzulesen, die uns UTF-8 nicht ermöglicht.    





                                      Untersuchung und Thesen


Beim einlesen dieser Daten können unterschiedliche Fragen gestellt werden und zwar:

=> Was sind die Absoluten Häufigkeiten der verfügbaren Länder?(Wie viel mal kommt jedes Land vor)
=>Welche Länder haben die meisten Zuschauer?
=>Welche  Mannschaften haben eine Besucherzahl weniger als den Durchschnitt?
=>Was ist das Punktverhältnis zwischen die Länder?
=>Welche Mannschaften schießen mehr als den Durchschnitt?
=>Welche Mannschaften gewinnen mehr oder weniger als den Durchschnitt?
=>Welche Spieler schießen mehr oder weniger als den Durchschnitt?
=> Wie sieht der Ligaausgleich über die Schießer aus? und vieles mehr..

Es werden auch unterschiedliche Thesen angenommen:
=>Die Englische Liga ist die Beste Liga  in Europa
=>Bayern aus Deutschland hat seit 9 Jahren die Deutsche Liga gewonnen. Sie werden nochmal dieses Jahr gewinnen
=>Da Lionel Messi nach Frankreich gewechselt ist wird er auch dort der Bestscorer sein, weil es in Barcelona immer der Fall war
=>Die Englische Liga wird am meisten geschaut bzw besucht 
=> Die italienische Liga ist schwer. Darunter bedeutet dass, die Mannschaften nicht nur viele Punkte im Laufe der Saison sammeln können, sondern  können auch die Spieler nicht so viele Toren schießen und vieles Mehr.

Wir werden einfach die Unterschiedlichen Fragen, die oben genannt wurden, visualisieren, eine Interpretation davon machen und am Ende sagen, ob die Thesen bestätigt oder abgelehnt wurden.











Besten FußballLänder in Europas
=======================================================================

Column { .tabset .tabset-fade data-width=600}
-----------------------------------------------------------------------

### FußballLänder Und Ihre Häufigkeiten

```{r}
 p1<-ggplot(yo , mapping=aes(x=Country)) +
     geom_bar(fill="blue", color="blue") +
     labs(
         title="5 Besten Meisterschaften", 
         subtitle="die 5 Besten FußballLänder und Ihre Häufigkeiten",
         x="Name Von Länder", 
         y="Absolute Häufigkeiten"
     ) 
ggplotly(p1)


```

### Länder und Anzahl von Mannschaften mit Besucherzahl kleiner als den Durchschnitt 

```{r}
p<-ggplot(hallo2 , mapping=aes(x=Country)) +
  geom_histogram(fill="red", color="red",stat="count" , breaks=seq(0, 20,4)) +
  
  labs(
    title="5 Besten Meisterschaften", 
    subtitle="Anzahl von Mannschaften pro Land mit wenigen Attendance",
    x="Name von Länder", 
    y="Absolute Häufigkeiten"
  ) +
  coord_flip()
ggplotly(p)
    
```



Column { data-width=400}
-----------------------------------------------------------------------

### FußballLänder und die Summe der Punkten Ihrer Clubs

```{r}
p2<-ggplot(hallo3) +
  geom_point(mapping=aes(x=Country, y=summe), 
             color="black",fill="black") +
  labs(
    title="5 Besten Länder und die Summe ihrer gesamten Punkten", 
    x="Name von Länder", 
    y="Gesamte Summe der Punkten"
  ) 
ggplotly(p2)

```

### Länder von der die Summe der Punkte Ihrer Mannschaften größer als den Durchschnitt

```{r}
 ggplot(hallo4 , mapping=aes(x=Country)) +
     geom_bar(fill="green", color="green") +
     labs(
         title=" Besten FußballLänder", 
         subtitle="FußballLänder mit Punkten größer als die Average",
         x="Namen von Länder", 
         y="Absoluten Häufigkeiten"
     ) 

```

Statistik der Mannschaften
=======================================================================
Column {.tabset .tabset-fade data-width=400}
-----------------------------------------------------------------------

### Mannschaften die mehr als den Schnitt gewonnen haben

```{r}
p3<-ggplot(hallo5) +
  geom_point(mapping=aes(x=W, y=Squad), 
             color="orange",fill="orange") +
  labs(
    title=" Beste Mannschaften die ueber der Average gewinnen", 
    y="Name von Mannschaften", 
    x="Anzahl von gewonnenen Spielen"
  )
ggplotly(p3)

```

### Mannschaften mit Punkten weniger als den Schnitt
```{r}
p4<-ggplot(hallo6) +
  geom_point(mapping=aes(x=Pts, y=Squad), 
             color="red",fill="red") +
  labs(
    title=" Schwache Mannschaften mit Punkten unter der Average ", 
    y="Name von Mannschaften", 
    x="Punkte der Mannschaften"
  )
ggplotly(p4)

```

Column {data-width=600}
-----------------------------------------------------------------------

### Mannschaften  mit Tordifferenz(geschossen minus kassiert) oberhalb den Schnitt

```{r}
p6<-ggplot(hallo7) +
  geom_point(mapping=aes(x=GD, y=Squad), 
             color="green",fill="green") +
  labs(
    title=" gute Mannschaften mit Tordifferenz ober den Schnitt ", 
    y="Name von Mannschaften", 
    x="Tordifferenz der Mannschaften"
  ) 
ggplotly(p6)

```

### Mannschaften mit schlechter Tordifferenz

```{r}
p5<-ggplot(hallo8) +
  geom_point(mapping=aes(x=GF, y=Squad), 
             color="blue",fill="blue") +
  labs(
    title=" Mannschaften mit Schlechter Tordifferenz ", 
    y="Name von Mannschaften", 
    x="Tordifferenz der Mannschaften"
  ) 
ggplotly(p5)

```

Informationen über die Spieler
=======================================================================
Column {.tabset .tabset-fade data-width=550}
-----------------------------------------------------------------------

### Schiessverhältnis zwischen die Ligas mit BestSchießer über den Schnitt
```{r}
p8<-ggplot(hallo10 , mapping=aes(x=Country)) +
     geom_bar(fill="orange", color="orange") +
     labs(
         title=" Ligas Goalausgleich", 
         subtitle=" Ligas mit mehr und Weniger BestSchießer",
         x="Name von Länder", 
         y="Anzahl der BestSchießer pro Land"
     ) 
ggplotly(p8)


```


### Spieler die über den Schnitt schiessen

```{r}
p7<-ggplot(hallo9) +
  geom_point(mapping=aes(x=GoalScored , y=BestScorer ), 
             color="black",fill="black") +
  labs(
    title="  Schiesser die über den Schnitt scoren", 
    y="Name der Spieler", 
    x="Anzahl der erzielten Toren"
  )
ggplotly(p7)

```




Column {data-width=450}
-----------------------------------------------------------------------

### Spieler mit der Besten GPMA(Tor pro Spiel Durchschnitt)
GPMA=Anzahl von erzielten Toren/ Anzahl von Spielen

```{r}
p9<-ggplot(hallo11) +
  geom_point(mapping=aes(x=GPMA , y=BestScorer ), 
             color="blue",fill="blue") +
  labs(
    title="  Schiesser die über den GPMA scoren", 
    y="Name der Spieler", 
    x="Tor pro Spiel Durchschnitt der Spieler"
  )
ggplotly(p9)

```

### Ligasausgleich mit Schnitt ihrer BestScorer

```{r}
p10<-ggplot(hallo10 , mapping=aes(x=Country)) +
     geom_bar(fill="violet", color="violet") +
     labs(
         title=" Ligas Goalausgleich über den GPMA", 
         subtitle=" Ligas mit mehr und Weniger BestScorer mit GPMA",
         x="Name von Länder", 
         y="Anzahl der BestScorer mit gutem GPMA pro Land"
     ) 
ggplotly(p10)

```

